[source, ipython3]
----
import numpy as np
----

[source, ipython3]
----
import findspark
findspark.init()

import pyspark
from pyspark.sql import SparkSession
from pyspark.sql.functions import expr, col, column

spark = SparkSession.builder.getOrCreate()
----



    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    <ipython-input-3-e31d9fa06a93> in <module>
          1 import findspark
    ----> 2 findspark.init()
          3 
          4 import pyspark
          5 from pyspark.sql import SparkSession


    /opt/rh/rh-python36/root/lib/python3.6/site-packages/findspark.py in init(spark_home, python_path, edit_rc, edit_profile)
        120 
        121     if not spark_home:
    --> 122         spark_home = find()
        123 
        124     if not python_path:


    /opt/rh/rh-python36/root/lib/python3.6/site-packages/findspark.py in find()
         31 
         32     if not spark_home:
    ---> 33         raise ValueError("Couldn't find Spark, make sure SPARK_HOME env is set"
         34                          " or Spark is in an expected location (e.g. from homebrew installation).")
         35 


    ValueError: Couldn't find Spark, make sure SPARK_HOME env is set or Spark is in an expected location (e.g. from homebrew installation).


[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .load("./data/BX-Book-Ratings.csv")
print(df.schema)
df.show(5)
----


----
StructType(List(StructField(User-ID,StringType,true),StructField(ISBN,StringType,true),StructField(Book-Rating,StringType,true)))
+-------+----------+-----------+
|User-ID|      ISBN|Book-Rating|
+-------+----------+-----------+
| 276725|034545104X|          0|
| 276726|0155061224|          5|
| 276727|0446520802|          0|
| 276729|052165615X|          3|
| 276729|0521795028|          6|
+-------+----------+-----------+
only showing top 5 rows

----

[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .option("inferSchema", "true")\
    .load("./data/BX-Users.csv")
df.printSchema()
df.show(5)
----


----
root
 |-- User-ID: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Age: string (nullable = true)

+-------+--------------------+----+
|User-ID|            Location| Age|
+-------+--------------------+----+
|      1|  nyc, new york, usa|NULL|
|      2|stockton, califor...|  18|
|      3|moscow, yukon ter...|NULL|
|      4|porto, v.n.gaia, ...|  17|
|      5|farnborough, hant...|NULL|
+-------+--------------------+----+
only showing top 5 rows

----

[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .option("inferSchema", "true")\
    .load("./data/BX-Books.csv")
print(df.schema)
df.select(expr("ISBN")).show(2)

df.count()
----


----
StructType(List(StructField(ISBN,StringType,true),StructField(Book-Title,StringType,true),StructField(Book-Author,StringType,true),StructField(Year-Of-Publication,IntegerType,true),StructField(Publisher,StringType,true),StructField(Image-URL-S,StringType,true),StructField(Image-URL-M,StringType,true),StructField(Image-URL-L,StringType,true)))
+----------+
|      ISBN|
+----------+
|0195153448|
|0002005018|
+----------+
only showing top 2 rows

----


[source, ipython3]
----

----
jhsdjkahsd
askdfaLSKDJAs
asdioaOPDA
[source, ipython3]
----
%matplotlib inline

import matplotlib.pyplot as plt
plt.figure(num='This is the title')
plt.plot([1,1.6,3])
----




[[rndg]]
image::../test1_files/test1_7_1.png[title="Nejaky nahodny graf"]
Viz <<rndg>> nejaky dalsi text.