+*In[14]:*+
[source, ipython3]
----
import numpy as np
----


+*In[32]:*+
[source, ipython3]
----
import findspark
findspark.init()

import pyspark
from pyspark.sql import SparkSession
from pyspark.sql.functions import expr, col, column

spark = SparkSession.builder.getOrCreate()
----


+*In[18]:*+
[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .load("./data/BX-Book-Ratings.csv")
print(df.schema)
df.show(5)
----


+*Out[18]:*+
----
StructType(List(StructField(User-ID,StringType,true),StructField(ISBN,StringType,true),StructField(Book-Rating,StringType,true)))
+-------+----------+-----------+
|User-ID|      ISBN|Book-Rating|
+-------+----------+-----------+
| 276725|034545104X|          0|
| 276726|0155061224|          5|
| 276727|0446520802|          0|
| 276729|052165615X|          3|
| 276729|0521795028|          6|
+-------+----------+-----------+
only showing top 5 rows

----


+*In[48]:*+
[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .option("inferSchema", "true")\
    .load("./data/BX-Users.csv")
df.printSchema()
df.show(5)
----


+*Out[48]:*+
----
root
 |-- User-ID: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- Age: string (nullable = true)

+-------+--------------------+----+
|User-ID|            Location| Age|
+-------+--------------------+----+
|      1|  nyc, new york, usa|NULL|
|      2|stockton, califor...|  18|
|      3|moscow, yukon ter...|NULL|
|      4|porto, v.n.gaia, ...|  17|
|      5|farnborough, hant...|NULL|
+-------+--------------------+----+
only showing top 5 rows

----


+*In[57]:*+
[source, ipython3]
----
df = spark.read.format("csv")\
    .option("sep",";")\
    .option("header", "true")\
    .option("inferSchema", "true")\
    .load("./data/BX-Books.csv")
print(df.schema)
df.select(expr("ISBN")).show(2)

df.count()
----


+*Out[57]:*+
----
StructType(List(StructField(ISBN,StringType,true),StructField(Book-Title,StringType,true),StructField(Book-Author,StringType,true),StructField(Year-Of-Publication,IntegerType,true),StructField(Publisher,StringType,true),StructField(Image-URL-S,StringType,true),StructField(Image-URL-M,StringType,true),StructField(Image-URL-L,StringType,true)))
+----------+
|      ISBN|
+----------+
|0195153448|
|0002005018|
+----------+
only showing top 2 rows

271379----


+*In[ ]:*+
[source, ipython3]
----

----
jhsdjkahsd
askdfaLSKDJAs
asdioaOPDA

+*In[59]:*+
[source, ipython3]
----
%matplotlib inline

import matplotlib.pyplot as plt
plt.figure(num='This is the title')
plt.plot([1,1.6,3])
----


+*Out[59]:*+
----[<matplotlib.lines.Line2D at 0x7fbfa5ecf278>]
![png](test1_files/test1_7_1.png)
----


+*In[ ]:*+
[source, ipython3]
----

----
